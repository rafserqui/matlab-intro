%========================================================================================
% Compilation should work with PDFLaTeX
%========================================================================================
% Type of document and general formatting
\documentclass[a4paper,11pt]{article}

\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\linespread{1.25}

%========================================================================================
% These packages are for language and font settings
\usepackage[english,activeacute]{babel} % Language
\usepackage{tgpagella}					% Text font
\usepackage[utf8]{inputenc}				% Special symbols
\usepackage[T1]{fontenc}				% T1 Encoding of font
\usepackage{lmodern}


%========================================================================================
%\usepackage[sc]{mathpazo}				% Math font
\usepackage{mathpazo}					% Math font
\usepackage{amsmath,amsfonts,amssymb}	% Math symbols
\usepackage{amsthm}
\usepackage{dsfont}						% Math symbols like R for reals...
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}

%========================================================================================
% Other packages
\usepackage{graphicx}
\usepackage{longtable}
\usepackage[svgnames]{xcolor}

%========================================================================================
\usepackage{accents}
\newcommand*{\dt}[1]{%
	\accentset{\mbox{\large\bfseries .}}{#1}} % Larger dot for time derivative


\usepackage{hyperref}
\hypersetup
{
    pdfauthor={Rafael Serrano-Quintero},
    pdfsubject={Intro to Matlab - PS2},
    colorlinks = {true},
    linkcolor = {FireBrick},
    citecolor = {FireBrick},
    urlcolor = {RoyalBlue},
}

\usepackage{appendix}
\usepackage{marvosym}
\usepackage{enumerate} %For enumerating with letters with option [a)]
\usepackage[inline]{enumitem}
\usepackage{fancyvrb}  %To reduce font size in verbatim environment
\usepackage{epstopdf}
\usepackage[flushleft]{threeparttable}
\usepackage{pdflscape}
\usepackage{natbib}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage[super]{nth}
\usepackage{float}

% New commands
\newcommand{\source}[1]{\caption*{\tiny Source: {#1}} }
\newcommand{\keywords}[1]{\textbf{\textit{Keywords:}} #1}
\newcommand{\jelcodes}[1]{\textbf{\textit{JEL Classification:}} #1}

\theoremstyle{definition}
\newtheorem{exercise}{Exercise}

%===========================================================
%===========================================================
		% === Title, thanks, and author data === %
%===========================================================
%===========================================================


\title{\textbf{Introduction to Matlab --- Problem Set II}}

\author{Rafael Serrano Quintero
\thanks{Department of Economics. Email: \href{mailto:rafael.serrano@ub.edu}{rafael.serrano@ub.edu}} \\
University of Barcelona \\}
\date{}


\begin{document}
\VerbatimFootnotes

\maketitle

\begin{exercise}
Given
\[
f(x) = x^{1/3}e^{-x^2}
\]

\begin{enumerate}
    \item Show theoretically that if we start from an initial guess $x_0$ close to $x^*$ where $f(x^*) = 0$, Newton-Raphson method diverges.
    \item Show in the computer that, with each iteration, the method in fact diverges. Note that $\displaystyle\lim_{x\rightarrow +\infty}f(x) = 0$ but this is an asymptote!
\end{enumerate}
\end{exercise}

\begin{exercise}
Write a function that computes the trapezoid rule for integration. The function should take as inputs the lower and upper bounds of the interval $a$ and $b$, the number of points on which to approximate the function $n$, and a function handle.
\begin{enumerate}
    \item Use your function to compute
    \[
    \int^5_1 x^2 dx \ \text{ and } \ \int^{74}_{23} \log(x) dx
    \]
    with $n = \{1,2,\ldots,35\}$ and report the relative errors in $\log_{10}$ units as a function of $n$. If the true value of the integral is $v$ and your estimate is $\hat{v}$, the relative error should be
    \[
    \xi = \log_{10}\left(\frac{\lvert v - \hat{v}\rvert}{\lvert \hat{v}\rvert}\right)
    \]
    \item Compare your results with the function \verb;trapz; from Matlab in terms of errors. Report a plot of the errors $\xi$ as a function of $n$ for your function and Matlab's and compute $\lVert \xi^M - \xi \rVert$ where $\xi^M$ are the errors from \verb;trapz;.
\end{enumerate}
\end{exercise}

\begin{exercise}
Given the function 

\[
f(x) = x^2 - \log\left(\frac{x^2}{3}\right)
\]

\begin{enumerate}
    \item Find a minimum of the function using the bracketing method. State clearly which initial triplet $(a,b,c)$ you start with and what solution you find.
    \item Find a minimum of the function using \verb;fminsearch; with initial condition $x_0 = \pm 2$.
    \item Compare the two procedures.
\end{enumerate}
\end{exercise}

\begin{exercise}
Suppose a consumer has \$$100$ to spend on two goods $c_1$ and $c_2$. The price of $c_1$ is \$$200$ per kilo while the price of $c_2$ is \$$300$ per kilo. Her utility function is given by
\[
U(c_1, c_2) = \sqrt{c_1} + 2\sqrt{c_2}
\]
Assume the consumer spends all her income in the two goods.
\begin{enumerate}
    \item State this maximization problem of two variables as a \textbf{minimization problem in one variable}. \underline{Hint:} Define the proportion spent on $c_1$ as $\phi$ and make a change of variables.
    \item Solve this problem by hand.
    \item Solve this problem as a problem in one variable using the bracketing method. How can you find the initial triplet $(a,b,c)$ \textbf{without} the routine explained in class? 
    \item Solve this problem as a problem in one variable using the Newton-Raphson method. Give a reasoning for your choice of the initial guess.
    \item Compare the results of both methods with the true solution, the number of iterations needed, and the tolerance set.
\end{enumerate}
\end{exercise}

\begin{exercise}
The CES production function defined as
\begin{equation}
F(K, L) = \left(\alpha K^{\frac{\sigma - 1}{\sigma}} + (1 - \alpha) L^{\frac{\sigma - 1}{\sigma}}\right)^{\frac{\sigma}{\sigma - 1}}
\label{eqn:ces_function}
\end{equation}
has a constant elasticity of substitution $\sigma$ and nests three particular cases. 
\begin{itemize}
    \item If $\sigma\rightarrow\infty$ the function becomes linear (perfect substitutes)
    \begin{equation}
    F(K,L) = \alpha K + (1 - \alpha)L
    \label{eqn:linear}
    \end{equation}
    \item If $\sigma\rightarrow 1$ the function becomes Cobb-Douglas
    \begin{equation}
    F(K,L) = K^{\alpha}L^{1-\alpha}
    \label{eqn:cobb_douglas}
    \end{equation}
    \item If $\sigma\rightarrow 0$ the function becomes Leontief (perfect complements)
    \begin{equation}
    F(K,L) = \min\{K,L\}
    \label{eqn:leontief}
    \end{equation}
\end{itemize}

\begin{enumerate}
    \item Write a function that takes four inputs, the elasticity $\sigma$, the distribution parameter $\alpha$, a vector of values for $K$ and a vector of values for $L$. The function should distinguish the three four different cases \eqref{eqn:ces_function}, \eqref{eqn:linear}, \eqref{eqn:cobb_douglas}, \eqref{eqn:leontief}. Show in a \verb;subplot; the three different cases with a $3-$D figure. \underline{Hint:} You might want to check \href{https://www.mathworks.com/help/matlab/ref/surf.html}{\texttt{surf}} command.
    \item Show numerically (preferably with a plot) that as $\sigma$ goes to $\{0, 1, \infty\}$ the CES approaches each case. \underline{Hint:} it might be easier to rewrite the function in intensive form, i.e. divide by $L$ and define $k = K/L$. Recall that the CES is homogeneous of degree $1$.
\end{enumerate}
\end{exercise}

\end{document}