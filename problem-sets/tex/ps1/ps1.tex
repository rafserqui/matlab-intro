%========================================================================================
% Compilation should work with PDFLaTeX
%========================================================================================
% Type of document and general formatting
\documentclass[a4paper,11pt]{article}

\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\linespread{1.25}

%========================================================================================
% These packages are for language and font settings
\usepackage[english,activeacute]{babel} % Language
\usepackage{tgpagella}					% Text font
\usepackage[utf8]{inputenc}				% Special symbols
\usepackage[T1]{fontenc}				% T1 Encoding of font
\usepackage{lmodern}


%========================================================================================
%\usepackage[sc]{mathpazo}				% Math font
\usepackage{mathpazo}					% Math font
\usepackage{amsmath,amsfonts,amssymb}	% Math symbols
\usepackage{amsthm}                     % Theorems
\usepackage{dsfont}						% Math symbols like R for reals...
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}

%========================================================================================
% Other packages
\usepackage{graphicx}
\usepackage{longtable}
\usepackage[svgnames]{xcolor}

%========================================================================================
\usepackage{accents}
\newcommand*{\dt}[1]{%
	\accentset{\mbox{\large\bfseries .}}{#1}} % Larger dot for time derivative


\usepackage{hyperref}
\hypersetup
{
    pdfauthor={Rafael Serrano-Quintero},
    pdfsubject={Intro to Matlab - PS1},
    colorlinks = {true},
    linkcolor = {FireBrick},
    citecolor = {FireBrick},
    urlcolor = {RoyalBlue},
}

\usepackage{appendix}
\usepackage{marvosym}
\usepackage{enumerate} %For enumerating with letters with option [a)]
\usepackage[inline]{enumitem}
\usepackage{fancyvrb}  %To reduce font size in verbatim environment
\usepackage{epstopdf}
\usepackage[flushleft]{threeparttable}
\usepackage{pdflscape}
\usepackage{natbib}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage[super]{nth}
\usepackage{float}

% New commands
\newcommand{\source}[1]{\caption*{\tiny Source: {#1}} }
\newcommand{\keywords}[1]{\textbf{\textit{Keywords:}} #1}
\newcommand{\jelcodes}[1]{\textbf{\textit{JEL Classification:}} #1}

\theoremstyle{definition}
\newtheorem{exercise}{Exercise}

%===========================================================
%===========================================================
		% === Title, thanks, and author data === %
%===========================================================
%===========================================================


\title{\textbf{Introduction to Matlab --- Problem Set I}}

\author{Rafael Serrano Quintero
\thanks{Department of Economics. Email: \href{mailto:rafael.serrano@ub.edu}{rafael.serrano@ub.edu}} \\
University of Barcelona \\}
\date{}


\begin{document}
\VerbatimFootnotes

\maketitle

\begin{exercise}
Simulate an AR(1) process. To do so, construct a function called \verb;my_ar_process; that takes as arguments the initial condition of the AR(1) $(y_0)$, the autoregressive parameter $(\rho)$, the length of the simulation $(T)$, and the variance of the error term $(\sigma^2)$. Recall an AR(1) takes the form:
    
\[
y_{t+1} = \rho y_t + \varepsilon_{t} \ ; \ \varepsilon\thicksim \mathcal{N}(0, \sigma^2)
\]

The function should return the vector $y_t$.

\textit{\underline{Hint:} loops might be useful in these cases. Check} \href{https://www.mathworks.com/help/matlab/ref/randn.html}{\texttt{randn}} \textit{function to generate random numbers.}

\begin{enumerate}
    \item Test the function with $T = 100$, $\rho = 0.95$, $y_0 = 0$, and $\sigma = 0.5$ and make a plot.
    \item Run $20$ different simulations and plot them together in a graph. Keep all parameters the same except the initial condition $y_0$ which should be drawn from a uniform distribution $U(10,15)$. Can you explain what happens with all the series?
\end{enumerate}
\end{exercise}

\begin{exercise}
Create a function \verb;my_polynomial; that evaluates a polynomial of degree $n$ given its coefficients. That is, let a polynomial $p(x)$ be defined as:

\[
p(x) = \sum^n_{i=1}a_i x^{i-1}
\]	
	
Write a function that takes as inputs a vector of coefficients $a_i$ and a value for $x$, then compute the value of the polynomial at that point $x$ given the coefficients. Do not use built-in functions such as \href{https://www.mathworks.com/help/matlab/ref/polyval.html}{\texttt{polyval}}.
\end{exercise}

\begin{exercise}
Download the series for real GDP per capita in quarterly basis from the Federal Reserve Bank of St. Louis (you can download them from \href{https://fred.stlouisfed.org/series/A939RX0Q048SBEA}{here}). The purpose of this exercise is that you familiarize yourself with extracting data from files and manipulate it in Matlab. Start this exercise in a new script, start by clearing the workspace and the command window.

\begin{enumerate}
  \item As a zero step, input the data as a variable called $Y_t$ (in Matlab, \verb;Yt;), and take the length of the series as a variable $T$ (\verb;T;). Compute also the growth rate of GDP per capita in this step and save it as another variable, for example $g_Y$ (\verb;gY;). Compute the growth rate as the difference in logs.
	\item First, suppose we want to just fit a time trend. To do so, suppose the model we have for the evolution of output is:
	\begin{equation}
	Y_t = e^{\phi_1 t + \phi_2} + \varepsilon_t \ ; \ \varepsilon_t \underset{iid}{\thicksim} \mathcal{N}(0,\sigma^2_{\varepsilon})
	\label{model_1}
	\end{equation}
	where $t$ is a time trend, $\phi_1$ and $\phi_2$ are the parameters of interest, and $\varepsilon$ is white noise. Your task is to estimate parameters $\phi_1$ and $\phi_2$ using \verb;lsqcurvefit; or \verb;lsqnonlin;. Explain why you choose those initial values. Plot the data, and the fitted curve.

	\item We will fit now the \textbf{growth rate} of GDP per capita using an $AR(2)$ specification.\footnote{Please, take into account this is an exercise, this is not a good way to forecast GDP nor almost any economic variable.}
	
		\begin{equation}
		g_{Y,t} = \alpha + \rho_1 g_{Y,t-1} + \rho_2 g_{Y,t-2} + u_t \ ; \ u_t \underset{iid}{\thicksim} \mathcal{N}(0, \sigma^2_u)
		\label{model_2}
		\end{equation}
		
	Where $\alpha$ is a constant, $\rho_1$ and $\rho_2$ are the autoregressive parameters of the model, and $u_t$ is white noise. Estimate this model via OLS. The estimator should be programmed \textbf{by yourselves}, do not use built-in functions or other user-defined functions not written by yoursleves. Obtain the parameters $\rho_1$, $\rho_2$, an estimate of $\hat{\sigma}^2_u$, and the variance-covariance matrix of the OLS estimator. Recall that:
		
		\begin{align}
		\mathbb{E}\left[(\hat{\rho}-\rho)(\hat{\rho}-\rho)'\right] &= \sigma^2\left(X'X\right)^{-1} \label{varcovOLS}\\
		\hat{\sigma}^2 &= \frac{\hat{u}' \hat{u}}{n-k} \label{sigmahat}
		\end{align}
		
	Where $(n-k)$ denotes the degrees of freedom, \eqref{varcovOLS} gives the Variance-Covariance Matrix for the OLS estimator, and \eqref{sigmahat} is the estimator for the variance of the residuals with $k$ the number of regressors.

	\item Plot the predicted values for the OLS estimates and the data for comparison. Clarify which series is which in a legend.
	\item Check \href{https://www.mathworks.com/help/econ/specify-ar-models.html}{\texttt{arima}} and \href{https://www.mathworks.com/help/econ/arima.estimate.html?s_tid=doc_ta}{\texttt{estimate}} {\tiny (check the first example!)} and compare the OLS results you obtained with the ones from Matlab.
\end{enumerate}
\end{exercise}



\end{document}
